#!/bin/bash

              
#: Title       : start_script

              
#: Date        : 2023-03-28

              
#: Author      : Osama Ahmed

              
#: Version     : 1.0

              
#: Description : update and upgrade shell and bash

              
#: Options     : None

current_directory=~/healthy150
start(){ 
    printf "%s\n"
    printf "%s\n" "============================";
    date '+%Y-%m-%d %H:%M:%S'
    printf "%s\n" "============================";
    log_seperator "start of update...";
    
    sudo apt update;
    log_seperator "end of update & start of upgrade";
    
    sudo apt upgrade -y;
    log_seperator "end of upgrade & start of bash upgrade";
    
    sudo apt-get install --only-upgrade bash;
    log_seperator "end of bash upgrade & start of ubuntu upgrade";
    
    sudo do-release-upgrade;
    if do-release-upgrade; then powershell.exe -command restart-computer;
    fi
    log_seperator "end of ubuntu upgrade";
    

    log_seperator "updating pip";
    
    python -m pip install --upgrade pip
    log_seperator "end of pip upgrade & start of flask upgrade";
    
    sudo apt-get install --only-upgrade flask;
    log_seperator "end of flask upgrade & try to enter home directory";
    
    if [ -d "$current_directory" ]; then
        cd "$current_directory";
        code .;
       log_seperator "The directory "$current_directory" is now open"
        
    else 
       log_seperator "The directory "$current_directory" does not exist...";
        
    fi
    if [ -f ~/healthy150/venv/bin/activate ];then
        . ~/healthy150/venv/bin/activate;
       log_seperator "The virtual environment is activated...";
       
    else
        printf "%s\n";
        log_seperator "There is no virtual environment...";
        
        # python3 -m venv venv
        # . ~/healthy150/venv/bin/activate;
        # printf "%s\n";
        # printf "%s\n" "============================";
        # printf "%s\n" "The virtual environment is created and activated...";
        # printf "%s\n" "============================";
        # printf "%s\n"
    fi
    flask_install;
    react frontend
    #TODO manage git
    git_control
    };
    start >> ~/healthy150/bin/log 2> ~/healthy150/bin/errorFile
    open_file ~/healthy150/bin/log